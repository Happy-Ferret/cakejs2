/* 
 * @Author: Linuxenko Svetlana 
 * @Project: CakeJS https://github.com/linuxenko/cakejs 
 */
!function(){"use strict";var a=function(){this.scope={libPath:"",appPath:"",params:[],modules:[]},this.route={name:"",routes:[],params:[]};var a=function(){var a=this,b=["jquery.js"],c=function(){var c,d,e=b.length,f=document.getElementsByTagName("script");for(c=0;c<f.length;c++)if(d=f[c],"string"==typeof d.getAttribute("data-main")){a.scope.libPath=d.getAttribute("src").match(/^(.*\/)\w+\.js$/)[1],a.scope.appPath=d.getAttribute("data-main");break}var g=function(){--e>0||a.require("app",null)};for(c in b)a.require(a.scope.libPath+b[c],g)};c()};this.load=function(a,b){var c=a.length,d=null,e=0;"undefined"!=typeof $&&(d=$.Deferred());var f=function(){--c<=0&&("function"==typeof b&&b(),null!==d&&d.resolve())};for(e in a)this.require(a[e],f.bind(this));return d},this.router=function(a){var b=this;b.route.routes=a;var c=function(a){var c=b.route.routes[a];if("undefined"!=typeof c.controllers)for(var d in c.controllers)b.require(c.controllers[d])},d=function(){var a=window.location.hash;if(a.length<1)return c("home");for(var d=a.split("/"),e=d[0].match(/^#(.*)$/)[1],f=[],g=1;g<d.length;g++)f.push(d[g]);b.route.name=e,b.route.params=f,c(e)};window.onpopstate=d,d()},this.findModule=function(a){for(var b in this.scope.modules)if(this.scope.modules[b].name==a)return this.scope.modules[b];return null},this.require=function(a,b){var c,d=this,e=a,f=b,g=null,h=(d.scope.modules,null);return"undefined"!=typeof $&&(g=$.Deferred()),"undefined"!=typeof e?null!==(h=d.findModule(e))?(g.resolve(h.module),"function"==typeof f&&f(h.module),void("function"==typeof h.module&&d.define(h.name,h.deps,h.module))):(e.match(/^.*\.js/)||(e=d.scope.appPath+e+".js"),c=document.createElement("script"),c.setAttribute("src",e),c.onload=c.onreadystatechange=function(){"function"==typeof f&&f(this),null!==g&&g.resolve(this)},c.onerror=function(a){null!==g&&g.reject(a)},document.head.appendChild(c),g):void 0},this.define=function(a,b,c){var d=this.scope.modules,e=this,f=function(a){for(var b in d)if(d[b].name==a)return!0;return!1},g=function(a){for(var b in a)if(!f(a[b]))return!1;return!0},h=function(a){f(a.name)||d.push(a)},i=function(a,b){var c=function(){if(g(a)&&"function"==typeof b){var c={};for(var d in a)c[a[d]]=e.findModule(a[d]).module;b(c)}};for(var d in a)this.require(a[d],c)},j=c;"string"==typeof a&&("undefined"==typeof j&&(j=b),"object"!=typeof b||"object"!=typeof c&&"function"!=typeof c?"function"==typeof j&&j():i.call(this,b,c),h({name:a,deps:b,module:j}))},this.t=function(a,b){var c=function(a){return a.innerHTML.replace(/<!--\?/gi,"<?").replace(/\?-->/gi,"?>")},d=function(a,b){var c=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<?").join("	").replace(/((^|\?>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)\?>/g,"',$1,'").split("	").join("');").split("?>").join("p.push('").split("\r").join("\\'")+"');return p.join('');};");return c(b)};return d(c(document.getElementById(a)),b)},a.call(this)};window.$c=new a}();