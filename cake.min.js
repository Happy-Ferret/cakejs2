/* https://github.com/linuxenko/cakejs */
(function(){var e=function(){this.scope={libPath:"",appPath:"",params:[],modules:[]};this.route={name:"",routes:[],params:[]};var e=function(){var e=this,t=["jquery.js"];var n=function(){iterations=t.length;var n=document.getElementsByTagName("script");for(var r=0;r<n.length;r++){var i=n[r];if(typeof i.getAttribute("data-main")=="string"){e.scope.libPath=i.getAttribute("src").match(/^(.*\/)\w+\.js$/)[1];e.scope.appPath=i.getAttribute("data-main");break}}var s=function(){if(--iterations>0)return;e.require("app",null)};for(var r in t)e.require(e.scope.libPath+t[r],s)};n()};this.router=function(e){var t=this;t.route.routes=e;var n=function(e){var n=t.route.routes[e];if(typeof n.controllers=="undefined")return;for(var r in n.controllers)t.require(n.controllers[r])};var r=function(){var e=window.location.hash;if(e.length<1)return n("home");var r=e.split("/");var i=r[0].match(/^#(.*)$/)[1];var s=[];for(var o=1;o<r.length;o++)s.push(r[o]);t.route.name=i;t.route.params=s;n(i)};window.onpopstate=r;r()};this.findModule=function(e){for(var t in this.scope.modules){if(this.scope.modules[t].name==e)return this.scope.modules[t]}return null};this.require=function(e,t){var n=this,e=e,t=t,r,i=null,s=n.scope.modules,o=null;if(typeof $!="undefined")i=$.Deferred();if(typeof e=="undefined")return;if((o=n.findModule(e))!=null){i.resolve(o.module);if(typeof t=="function")t(o.module);if(typeof o.module=="function")n.define(o.name,o.deps,o.module);return}if(!e.match(/^.*\.js/))e=n.scope.appPath+e+".js";r=document.createElement("script");r.setAttribute("src",e);r.onload=r.onreadystatechange=function(){if(typeof t=="function")t(this);if(i!=null)i.resolve(this)};r.onerror=function(e){if(i!=null)i.reject(e)};document.head.appendChild(r);return i};this.define=function(e,t,n){var r=this.scope.modules,i=this;var s=function(e){for(var t in r){if(r[t].name==e)return true}return false};var o=function(e){for(var t in e)if(!s(e[t]))return false;return true};var u=function(e){if(!s(e.name))r.push(e)};var a=function(e,t){var n=function(){if(!o(e)||typeof t!="function")return;var n=new Object;for(var r in e){n[e[r]]=i.findModule(e[r]).module}t(n)};for(var r in e)this.require(e[r],n)};var f=n;if(typeof e!="string")return;if(typeof f=="undefined")f=t;if(typeof t=="object"&&(typeof n=="object"||typeof n=="function"))a.call(this,t,n);else if(typeof f=="function")f();u({name:e,deps:t,module:f})};this.t=function(e,t){var n=function(e){return e.innerHTML.replace(/<!--\?/gi,"<?").replace(/\?-->/gi,"?>")};var r=function(e,t){var n=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<?").join("	").replace(/((^|\?>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)\?>/g,"',$1,'").split("	").join("');").split("?>").join("p.push('").split("\r").join("\\'")+"');return p.join('');};");return n(t)};return r(n(document.getElementById(e)),t)};e.call(this)};window.$c=new e})()